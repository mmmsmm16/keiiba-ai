競馬予想AIにおける学習データ期間の最適化：5年対10年の精度比較と構造的変化の影響に関する包括的調査報告書
エグゼクティブサマリー
金融市場予測と同様に、競馬予想AIの開発において「学習データの期間（Training Window）」は、モデルの性能を決定づける最も重要なハイパーパラメータの一つである。本報告書では、直近5年分のデータセットと10年分以上のデータセットを用いた場合の予測精度および回収率（ROI）への影響について、国内外の論文、技術コンペティション（Kaggle等）、および日本の競馬データサイエンスコミュニティによる検証記事を網羅的に調査・分析した。
調査の結果、学習期間の最適解は単一の数値ではなく、採用するアルゴリズム（Deep Learning対GBDT）と、対象とする競馬環境の構造的変化（JRAのルール変更やコース改修）に強く依存することが判明した。具体的には、血統や騎手の潜在能力推定には10年〜30年の長期データが不可欠である一方、実際の勝敗予測やオッズの歪みを突くタスクにおいては、3年〜7年のデータを用いたモデルが最も高い回収率を記録する傾向にある。これは「概念ドリフト（Concept Drift）」と呼ばれる統計的現象と、2023年のJRA斤量ルール改定や京都競馬場の改修といった物理的な環境変化が、古いデータを「ノイズ」化させていることに起因する。
本報告書は、これらのファクターを統計学的および競馬工学的観点から詳細に論じ、現代のJRA環境において推奨されるハイブリッドなデータ戦略を提言するものである。
1. 序論：アルゴリズム競馬予想における「時間の壁」
競馬予想AIの構築において、開発者が最初に直面するジレンマは「データの量」と「データの鮮度」のトレードオフである。一般に、機械学習においては「大数の法則」に基づき、データ量が多ければ多いほどモデルの分散が低下し、汎化性能が向上すると考えられている。しかし、競馬というドメインにおいては、この定説が必ずしも当てはまらない特異な事情が存在する。
1.1 データの非定常性と市場の効率化
競馬データは時系列データであり、その生成過程は「非定常（Non-stationary）」である。すなわち、過去のデータを作り出した確率分布と、現在のデータを作り出している確率分布が異なっている。
市場効率の変化: 10年前のオッズ形成プロセスと現在のそれとは根本的に異なる。インターネット投票の普及、AI予想の台頭により、オッズの歪み（Arbitrage）はより迅速に解消されるようになった1。10年前の「過小評価された馬」のパターンを学習しても、現代の市場ではすでに織り込み済みであり、期待値はマイナスとなる。
物理的環境の変化: 馬場造成技術の進化、排水設備の向上、クッション値の導入などにより、走破タイムや有利な脚質（Track Bias）は経年的に変化している2。
1.2 本報告書の目的と構成
本報告書では、以下の問いに対する明確な解を提示することを目的とする。
精度の分岐点: 5年のデータと10年のデータでは、的中率と回収率にどのような統計的有意差が生じるか。
構造変化の影響: JRAにおける大規模な環境変化（京都改修、斤量改定）は、長期学習データの有効性をどのように毀損するか。
アルゴリズム別の適性: ニューラルネットワークと勾配ブースティング決定木（LightGBM等）では、要求されるデータ期間がどう異なるか。
2. 理論的枠組みと検証手法の基礎
具体的な検証結果の比較に入る前に、競馬データ分析における期間設定の理論的背景を整理する。
2.1 季節性と「13ヶ月ルール」
競馬予想モデルにおける最小の学習単位は「1年」ではなく「13ヶ月」であるとされる3。これは季節性（Seasonality）を捕捉するためである。
メカニズム: 馬は生物であり、冬毛の生え変わりや気温による代謝の変化がパフォーマンスに影響する。また、芝の状態も季節により劇的に変化する。
5年対10年:
5年データ: 季節サイクルを5回観測できるため、特異な気象条件（例：記録的暖冬）の影響をある程度平準化できる。
10年データ: 10回のサイクルにより、エルニーニョ現象などの長期気象変動を含むより堅牢な季節調整が可能となる。
2.2 希少事象とスパース性（Sparsity）
特定の条件（例：「札幌競馬場×重馬場×外国人騎手×外枠」）は、発生頻度が極めて低い。
5年データの限界: このような複合条件下でのレースは数回しか存在しない可能性がある。その数回がたまたま1番人気馬の勝利だった場合、AIは「この条件なら勝率100%」という過学習（Overfitting）を起こすリスクがある。
10年データの優位性: 観測期間を倍にすることでサンプルサイズを確保し、確率推定の信頼区間を狭めることができる。ニューラルネットワークのような「データ食い」のモデルにおいて長期データが推奨される主たる理由はこの点にある4。
2.3 概念ドリフト（Concept Drift）と共変量シフト
一方で、期間を延ばすことには致命的なリスクも伴う。それが「概念ドリフト」である。
定義: 入力 $X$ と出力 $y$ の関係性 $P(y|X)$ が時間とともに変化すること。
競馬における実例: 10年前は「内枠有利」が顕著だったコースが、路盤改修により「フラット」または「外枠有利」に変化した場合、10年前のデータは現在の予測にとってノイズとなるだけでなく、誤ったバイアスをモデルに植え付ける有害なデータとなる5。
3. 実証研究と比較：5年 vs 10年データの検証事例
本章では、収集されたリサーチスニペットに基づき、具体的な検証事例を分析する。
3.1 【事例1】京都競馬場におけるスライディングウィンドウ検証（LightGBM）
ある開発者による技術ブログ6では、2009年から2019年までの約10年分のJRAデータ（京都競馬場特化）を用いた詳細な検証が行われている。ここでは、単に10年分をまとめて学習するのではなく、検証期間をずらしながら評価する「Walk-Forward Validation」が採用された。
検証プロトコル
使用アルゴリズム: LightGBM（勾配ブースティング決定木）
データセット: 2009年〜2019年のレースデータ
分割手法:
学習: 2009-2012 (4年) $\rightarrow$ テスト: 2013
学習: 2009-2013 (5年) $\rightarrow$ テスト: 2014
...
学習: 2009-2018 (10年) $\rightarrow$ テスト: 2019
結果と考察
この検証が示唆するのは、データの「蓄積」が必ずしも精度向上に直結しないという点である。合計7年分のシミュレーションが行われたが、モデルは常に「直近の数年＋過去の蓄積」を用いて翌年を予測している。
特徴量の鮮度: 特徴量として「前走3レース分のデータ」を使用しており、これがない古い馬のデータは削除されている。つまり、10年前のレース結果そのものよりも、「その時点での馬の勢い（Trend）」と結果の関係性を学習している。
精度の飽和: LightGBMのような決定木ベースのモデルでは、ある程度のデータ量（数万レース、約3〜5年分）を超えると、精度の向上が頭打ちになる傾向が見られる。むしろ、古すぎるデータが含まれることで、現在のトラックバイアスと矛盾する分岐が作成されるリスクがある。
3.2 【事例2】海外研究における長期間データの扱い（Kaggle等）
Kaggleで開催された「Big Data Derby 2022」1や、その他の学術論文9では、1990年から2020年といった30年規模の超長期データが提供されることがある。上位解法の分析から、長期データと短期データの使い分けに関する重要な知見が得られる。
長期データ（10年〜30年）の用途
勝敗予測モデルの直接的な学習データとしてではなく、主に「エンべディング（埋め込み表現）」の作成に使用される。
血統ベクトル: 30年分の血統データを解析し、種牡馬や繁殖牝馬の遺伝的特徴をベクトル化する。
騎手・調教師のスキル推定: Eloレーティングのように、長期的なキャリアを通じた実力値を算出する。これらは不変的な特性（Invariant Features）と見なされる。
短期データ（直近2年〜5年）の用途
実際のレース結果（目的変数）の予測モデルにおいては、直近のデータが重視される。
トラックバイアスの補正: コース形状やメンテナンス状況に依存するため。
市場オッズの傾向: 馬券購入者の行動変容を反映するため。
比較結論: 世界的なデータサイエンス競技において、モデルの「基礎体力（Feature Engineering）」を作るには10年以上のデータが有利であるが、モデルの「意思決定（Prediction）」を最適化するには、直近のデータに重みを置く戦略が主流である12。
3.3 【事例3】1年分データの特化型モデル（回収率116%）
Qiita上の検証記事13では、わずか「1年間」の学習データを用いたモデルが報告されている。
結果: 的中率26%、回収率116%。
メカニズム: データ量が少ないため、モデルは複雑なパターン（高次の交互作用）を学習できず、非常にシンプルな「強い馬」の法則を見つけることに特化する。結果として、過学習が抑制され、汎化性能が維持された可能性がある。
示唆: 「精度（Accuracy）」を追求すれば10年データが勝る（万馬券のようなレアケースを拾えるため）が、「利益（Profit）」を追求する場合、市場の現在の歪みにフィットした短期データモデルが高いパフォーマンスを出す逆説的な現象が存在する。
4. JRAにおける構造的変化（Regime Change）の影響
日本競馬（JRA）において「10年分のデータ」を無批判に使用することが危険である最大の理由は、ここ数年で発生した不可逆的な構造変化にある。これを無視したモデルは、前提条件が崩れた世界で予測を行うことになる。
4.1 京都競馬場の大規模改修（2020年〜2023年）
京都競馬場は2020年11月から2023年4月まで、開設以来最大規模の改修工事のために開催を休止した14。
物理的変化: パドック形状の変更（円形から楕円形へ）、スタンド改築、路盤および排水設備の更新。
データの分断:
旧京都（〜2020）: 特有の「淀の坂」による下り坂での加速、イン突き有利の馬場傾向。
新京都（2023〜）: 路盤更新により、クッション値や砂の質が変化。初期のデータでは、従来の内枠有利傾向が薄れ、外枠差しが決まるケースも散見される2。
10年学習の弊害: 2014年〜2024年のデータセットを用いると、その大半（約6年分）は「旧京都」のデータである。モデルは「京都＝内枠有利」という強力なバイアスを学習するが、これは「新京都」には当てはまらない可能性がある。5年データ（2019〜2024）を用いた場合、京都のデータは実質的に改修後のもの（と少量の休止前）に限られるため、ノイズは減るがサンプルサイズ不足という別の問題に直面する。
4.2 2023年 斤量ルールの改定
JRAは騎手の健康管理と福祉向上を目的として、2023年から負担重量（斤量）の基準を引き上げた16。
変更内容: 平地競走における基礎重量が実質的に1kg増加。3歳馬や古馬の基本斤量が、例えば56kgから57kgへ変更された。
統計的影響:
スピード指数への影響: 競馬において「斤量1kg＝1馬身（約0.2秒）」という経験則が存在するが、過去10年のデータにおいて「58kg」を背負って勝った馬は「非常に強い（Hレベル）」と評価される。しかし、2023年以降の「58kg」は標準的な斤量であり、過去の58kgと同等の価値はない。
モデルの混乱: 10年分のデータをそのまま学習させると、AIは「58kg＝過酷な条件」と認識し、2023年以降のレースで58kgを背負う有力馬の評価を不当に下げる（過小評価する）リスクがある。
対策: 過去データの斤量に+1kgの補正を加えるか、学習期間を「新ルール適用後（または直近5年）」に絞り、新環境での斤量耐性を再学習させる必要がある。
5. アルゴリズムとデータ期間の相性比較
学習データ期間の最適解は、使用する機械学習アルゴリズムによっても異なる。ソースコードや検証記事から読み取れる傾向を以下にまとめる。
5.1 ニューラルネットワーク（Deep Learning）
推奨期間: 10年以上
理由: ニューラルネットワークは、データの背後にある非線形な関係性を抽出する能力に長けているが、パラメータ数が膨大であるため、収束には大量のデータを必要とする。5年程度のデータでは、過学習を起こすか、十分な特徴抽出ができずにロジスティック回帰と同程度の精度に留まることが多い18。
活用法: 10年〜20年のデータを用いて「馬の強さ」「血統の適性」を事前学習（Pre-training）し、直近データでファインチューニングする手法が有効である。
5.2 勾配ブースティング決定木（LightGBM, XGBoost）
推奨期間: 3年〜7年
理由: テーブルデータ（表形式データ）において現在最強とされるGBDT系モデルは、決定木のアンサンブルによって予測を行う。これらのモデルはデータのノイズに敏感であり、構造変化（ドリフト）を含んだ古いデータを大量に入れると、決定木の分岐ルールが汚染される。
検証結果: 多くの個人開発者やデータサイエンティストが、3年〜5年程度のデータで高い回収率を報告している4。これは、GBDTが「現在のレース傾向」をルールベースで切り出すのに適しているためである。
5.3 ロジスティック回帰・ナイーブベイズ
推奨期間: 3年〜5年
理由: これらの単純なモデルは、データの量が増えても表現力（Capacity）に限界があるため、ある一定量を超えると精度が飽和する（10における比較研究参照）。10年分のデータを入れても計算コストが増えるだけで、予測精度の有意な向上は見込めない場合が多い。
6. 的中率（Accuracy）と回収率（Recovery Rate）の逆説
本調査で浮き彫りになった最も重要な洞察の一つは、「精度の高いAI」が必ずしも「儲かるAI」ではないという点である。
6.1 長期データによる「正解」への収束
10年分のデータを学習したAIは、レースの物理法則（速い馬が勝つ）を極めて正確に学習する。
結果: 1番人気や2番人気になるような「本当に強い馬」を高い確率で当てる（的中率が高い）。
副作用: しかし、大衆（オッズ）もまた、過去の実績に基づいて強い馬を支持する。そのため、AIが自信を持って推奨する買い目はオッズが低く、長期的には控除率（テラ銭）の壁を超えられず、回収率は75〜80%に収束する9。
6.2 短期データによる「歪み」の発見
一方、直近5年（あるいはさらに短い期間）に絞ったAIは、長期的なセオリーよりも「今のトレンド」を重視する。
具体例: 「特定の種牡馬の産駒が、今の京都の荒れた馬場で急激に勝率を上げている」といった短期トレンドを検知する。
結果: 的中率は下がる（ノイズも拾うため）が、大衆がまだ気づいていない（オッズに織り込まれていない）穴馬を発見できる可能性が高まる。結果として、回収率が100%を超える「正の期待値」を持つモデルになり得る13。
以下の表は、学習データ期間とパフォーマンス指標の一般的な関係をまとめたものである。
表1: 学習データ期間によるパフォーマンス特性の比較
指標
5年データ（短期重視）
10年データ（長期重視）
的中率 (Accuracy)
中程度 (分散が大きい)
高 (安定している)
回収率 (ROI)
高 (市場の歪みを突きやすい)
低 (ポピュラーな解に収束しやすい)
希少事象への対応
弱 (データ不足で無視される)
強 (十分なサンプルがある)
構造変化への耐性
強 (新環境に素早く適応)
弱 (旧環境のバイアスを引きずる)
適正アルゴリズム
LightGBM, XGBoost
Neural Networks, Deep Learning
JRA斤量改定の影響
軽微 (新ルールの比率が高い)
甚大 (補正なしでは使用不可)

7. 結論と戦略的提言：ハイブリッド・アプローチの推奨
直近5年分と10年分の学習データ比較に関する調査の結果、単純な二者択一ではなく、目的に応じた使い分けと統合が最適解であることが確認された。現代のJRA環境において、AI予想モデルを構築する際の推奨戦略を以下に提言する。
7.1 「時間減衰（Time Decay）」の導入
データを「使う/捨てる」の0/1で判断するのではなく、サンプルの重み付け（Sample Weighting）を行うべきである。
手法: 損失関数において、直近のデータの重みを高く、過去のデータの重みを低く設定する。
例: 2024年のデータ $w=1.0$、2014年のデータ $w=0.1$
効果: これにより、10年分のデータが持つ「サンプル数の多さ（希少事象のカバー）」と、5年分のデータが持つ「鮮度の高さ（トレンドへの追従）」の両立が可能となる。
7.2 特徴量エンジニアリングと学習期間の分離
エンティティ学習（10年〜30年）: 騎手、調教師、種牡馬の能力値（レーティング）算出には、可能な限り長い期間のデータを使用する。Kaggleの上位解法と同様のアプローチである。
コンテキスト学習（3年〜5年）: 「このコースで、この騎手と血統の組み合わせが勝てるか」という判定モデル（GBDT等）の学習には、直近5年程度のデータを使用する。特に京都競馬場に関しては、2023年4月以降のデータを特別扱い（重み増強）する必要がある。
7.3 古いデータの「クリーニング」
10年分のデータを使用する場合は、以下の前処理が必須となる。
斤量補正: 2023年以前のデータの斤量に+1kgを一律加算し、エネルギー負荷の次元を合わせる。
新馬戦の除外: データとしての安定性が低い新馬戦（Shinba）は、長期学習データから除外するか、別モデルで扱う21。
オッズのインフレ調整: 過去のオッズと現在のオッズの分布を比較し、正規化を行う。
結論
精度の観点からは、10年以上のデータを用いた特徴量生成と、直近5年（および直近トレンドへの重み付け）を用いたモデル学習を組み合わせることが、最も合理的かつ高精度なアプローチである。単に「直近5年のみ」を使用するとスパース性の問題で不安定になり、「単純に10年」を使用すると構造変化のバイアスで回収率が低下する。この「期間のパラドックス」を解決するハイブリッドな設計こそが、現代の競馬予想AIにおける勝利の鍵である。
引用文献
Predicting Horse Races — Learnings from revisiting after a 4 year hiatus - Medium, 12月 10, 2025にアクセス、 https://medium.com/@qemtek/predicting-horse-races-learnings-from-revisiting-after-a-4-year-hiatus-9005b15cd2eb
【ダート】クッション砂の産地変更によるレースへの影響 - DMMオンラインサロン, 12月 10, 2025にアクセス、 https://lounge.dmm.com/detail/3562/content/39090/
Comparative analysis of data mining versus human intuition in the prediction of horse race outcomes, 12月 10, 2025にアクセス、 https://norma.ncirl.ie/8557/1/seandwyer.pdf
競馬AIで当たらない理由は見方と使い方！勝率が180度変わる方法, 12月 10, 2025にアクセス、 https://www.johnhancockcenterchicago.com/column/ai-keibanohit/
How Historical Horse Racing Data Transforms Modern Betting Systems - Sportbex, 12月 10, 2025にアクセス、 https://sportbex.com/blog/historical-horse-racing-data-for-modern-betting/
競馬予想 機械学習(LightGBM)で回収率100%超えたと思ったら、やらかしてた話 - Qiita, 12月 10, 2025にアクセス、 https://qiita.com/gara_gara/items/3e099c24280d772e7086
Big Data Derby 2022 | Kaggle, 12月 10, 2025にアクセス、 https://www.kaggle.com/competitions/big-data-derby-2022/data
Big Data Derby 2022 | Kaggle, 12月 10, 2025にアクセス、 https://www.kaggle.com/competitions/big-data-derby-2022
Use Case #3: Horse Racing Prediction : A Machine Learning Approach (Part 1) - CodeWorks, 12月 10, 2025にアクセス、 https://www.codeworks.fr/articles/use-case-3-horse-racing-prediction-a-machine-learning-approach-part-1
Predicting Outcomes of Horse Racing using Machine Learning - International Journal on Recent and Innovation Trends in Computing and Communication, 12月 10, 2025にアクセス、 https://ijritcc.org/index.php/ijritcc/article/download/8119/6540/8942
Optimizing Horse Racing Predictions through Ensemble Learning and Automated Betting Systems - ResearchGate, 12月 10, 2025にアクセス、 https://www.researchgate.net/publication/385301910_Optimizing_Horse_Racing_Predictions_through_Ensemble_Learning_and_Automated_Betting_Systems
Horse Racing - Kaggle, 12月 10, 2025にアクセス、 https://www.kaggle.com/datasets/hwaitt/horse-racing
機械学習で競馬の回収率140%超を達成：開発までの話 - Qiita, 12月 10, 2025にアクセス、 https://qiita.com/umaro_ai/items/d1e0b61f90098ee7fbcb
京都競馬場が変わる（青木行雄） - 競馬ブック コラム, 12月 10, 2025にアクセス、 https://column.keibabook.co.jp/trrepo/2357/
生まれ変わる京都競馬場 | OBAYASHI Thinking - 大林組, 12月 10, 2025にアクセス、 https://www.obayashi.co.jp/thinking/detail/project78.html
【馬券データ分析】斤量体重比 2026｜【中央競馬に関するアレコレ】kirari - note, 12月 10, 2025にアクセス、 https://note.com/kirari394/n/n85676b3f9b09
来年から変更となるJRAの負担重量 2003年以来20年ぶりの変更の狙いとは | 競馬ニュース, 12月 10, 2025にアクセス、 https://news.netkeiba.com/?pid=news_view&no=213359
Horse racing prediction using graph-based features. - ThinkIR, 12月 10, 2025にアクセス、 https://ir.library.louisville.edu/cgi/viewcontent.cgi?article=4083&context=etd
競馬予想におけるAIと人間の予想の精度比較結果とその理由とは？ | クラウド部, 12月 10, 2025にアクセス、 https://cloudbu.net/ai-03/
Laying Drifters During Last Moments Of Race? - Betfair forum, 12月 10, 2025にアクセス、 https://forum.betangel.com/viewtopic.php?t=9357
update:機械学習で競馬を予想しよう(プログラミング超初心者向け)/前準備編 - note, 12月 10, 2025にアクセス、 https://note.com/tetorakeiba/n/n0a4477d1527e


