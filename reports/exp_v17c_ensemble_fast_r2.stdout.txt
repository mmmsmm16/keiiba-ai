[2026-02-07 16:37:32] Loading data: data/processed/preprocessed_data_v12.parquet
[2026-02-07 16:37:32] Using 315 columns
[2026-02-07 16:37:37] rows train=237437 valid=46994 test=47607
[2026-02-07 16:37:37] Loaded payout map races=3454 for years=[2024]
[2026-02-07 16:37:38] Loaded payout map races=3455 for years=[2025]
[2026-02-07 16:37:38] [1/3] loading model lgbmA
[2026-02-07 16:37:38] [2/3] loading model mlpB
[2026-02-07 16:37:39] [3/3] loading model xgbPrev
[2026-02-07 16:37:40] weight vectors=15
[2026-02-07 16:37:40] [blend 1/15] policy search start: 4
[2026-02-07 16:37:47] [blend 1/15] new feasible roi=82.20 hit=0.474 tickets=20793 (1/4)
[2026-02-07 16:38:13] [blend 1/15] progress 4/4 bestU=79.84
[2026-02-07 16:38:19] best update blend=1 validROI=82.20 testROI=83.78
[2026-02-07 16:38:19] [blend 2/15] policy search start: 4
[2026-02-07 16:38:26] [blend 2/15] new feasible roi=82.86 hit=0.478 tickets=20757 (1/4)
[2026-02-07 16:38:44] [blend 2/15] new feasible roi=83.25 hit=0.470 tickets=20893 (3/4)
[2026-02-07 16:38:51] [blend 2/15] progress 4/4 bestU=81.44
[2026-02-07 16:38:59] best update blend=2 validROI=83.25 testROI=85.78
[2026-02-07 16:38:59] [blend 3/15] policy search start: 4
[2026-02-07 16:39:09] [blend 3/15] new feasible roi=83.92 hit=0.478 tickets=20739 (1/4)
[2026-02-07 16:39:23] [blend 3/15] new feasible roi=83.95 hit=0.472 tickets=20872 (3/4)
[2026-02-07 16:39:31] [blend 3/15] progress 4/4 bestU=82.20
[2026-02-07 16:39:42] best update blend=3 validROI=83.95 testROI=83.93
[2026-02-07 16:39:42] [blend 4/15] policy search start: 4
[2026-02-07 16:39:49] [blend 4/15] new feasible roi=83.58 hit=0.479 tickets=20823 (1/4)
[2026-02-07 16:40:14] [blend 4/15] progress 4/4 bestU=81.21
[2026-02-07 16:40:21] [blend 5/15] policy search start: 4
[2026-02-07 16:40:27] [blend 5/15] new feasible roi=83.45 hit=0.480 tickets=20777 (1/4)
[2026-02-07 16:40:42] [blend 5/15] new feasible roi=83.88 hit=0.474 tickets=20910 (3/4)
[2026-02-07 16:40:53] [blend 5/15] progress 4/4 bestU=81.93
[2026-02-07 16:41:01] progress 5/15
[2026-02-07 16:41:01] [blend 6/15] policy search start: 4
[2026-02-07 16:41:08] [blend 6/15] new feasible roi=82.78 hit=0.479 tickets=20857 (1/4)
[2026-02-07 16:41:32] [blend 6/15] progress 4/4 bestU=80.39
[2026-02-07 16:41:38] [blend 7/15] policy search start: 4
[2026-02-07 16:41:45] [blend 7/15] new feasible roi=84.73 hit=0.469 tickets=20844 (1/4)
[2026-02-07 16:42:13] [blend 7/15] progress 4/4 bestU=82.48
[2026-02-07 16:42:21] best update blend=7 validROI=84.73 testROI=82.41
[2026-02-07 16:42:21] [blend 8/15] policy search start: 4
[2026-02-07 16:42:32] [blend 8/15] new feasible roi=82.48 hit=0.472 tickets=20791 (1/4)
[2026-02-07 16:42:54] [blend 8/15] progress 4/4 bestU=80.16
[2026-02-07 16:43:04] [blend 9/15] policy search start: 4
[2026-02-07 16:43:11] [blend 9/15] new feasible roi=82.82 hit=0.477 tickets=20756 (1/4)
[2026-02-07 16:43:36] [blend 9/15] progress 4/4 bestU=80.45
[2026-02-07 16:43:43] [blend 10/15] policy search start: 4
[2026-02-07 16:43:50] [blend 10/15] new feasible roi=83.66 hit=0.479 tickets=20733 (1/4)
[2026-02-07 16:44:15] [blend 10/15] progress 4/4 bestU=81.26
[2026-02-07 16:44:22] progress 10/15
[2026-02-07 16:44:22] [blend 11/15] policy search start: 4
[2026-02-07 16:44:28] [blend 11/15] new feasible roi=84.10 hit=0.479 tickets=20729 (1/4)
[2026-02-07 16:44:47] [blend 11/15] new feasible roi=84.25 hit=0.456 tickets=20932 (3/4)
[2026-02-07 16:44:54] [blend 11/15] progress 4/4 bestU=83.39
[2026-02-07 16:45:01] best update blend=11 validROI=84.25 testROI=82.94
[2026-02-07 16:45:01] [blend 12/15] policy search start: 4
[2026-02-07 16:45:08] [blend 12/15] new feasible roi=82.90 hit=0.476 tickets=20738 (1/4)
[2026-02-07 16:45:26] [blend 12/15] new feasible roi=97.21 hit=0.423 tickets=21329 (3/4)
[2026-02-07 16:45:33] [blend 12/15] progress 4/4 bestU=98.51
[2026-02-07 16:45:42] best update blend=12 validROI=97.21 testROI=89.83
[2026-02-07 16:45:42] [blend 13/15] policy search start: 4
[2026-02-07 16:45:52] [blend 13/15] new feasible roi=83.44 hit=0.474 tickets=20874 (1/4)
[2026-02-07 16:46:14] [blend 13/15] progress 4/4 bestU=81.14
[2026-02-07 16:46:24] [blend 14/15] policy search start: 4
[2026-02-07 16:46:30] [blend 14/15] new feasible roi=85.08 hit=0.479 tickets=20735 (1/4)
[2026-02-07 16:46:57] [blend 14/15] progress 4/4 bestU=82.67
[2026-02-07 16:47:05] [blend 15/15] policy search start: 4
[2026-02-07 16:47:13] [blend 15/15] new feasible roi=82.53 hit=0.475 tickets=20895 (1/4)
[2026-02-07 16:47:40] [blend 15/15] progress 4/4 bestU=80.18
[2026-02-07 16:47:47] progress 15/15
[2026-02-07 16:47:47] === FINAL RESULT ===
{
  "blend_id": 12,
  "weights": {
    "lgbmA": 0.5,
    "mlpB": 0.0,
    "xgbPrev": 0.5
  },
  "valid_utility": 98.5083707933052,
  "valid_blended_roi": 97.20755778517511,
  "valid_blended_hit": 0.42276422764227645,
  "valid_tickets": 21329,
  "valid_coverage": 0.9971048060220035,
  "test_utility": 91.41158722234091,
  "test_blended_roi": 89.82622136868237,
  "test_blended_hit": 0.4096980255516841,
  "test_tickets": 21349,
  "test_coverage": 0.9971048060220035,
  "policy": {
    "gamma": 0.0,
    "bonus": 0.0,
    "axis_p": 0.05,
    "axis_min_odds": 1.0,
    "axis_min_edge": 0.0,
    "axis_mode": "hybrid",
    "partner_mode": "value",
    "win_ev": 0.9,
    "pair_n": 2.0,
    "trio_n": 0.0
  }
}
[2026-02-07 16:47:47] Saved report: reports/exp_v17c_ensemble_fast_r2.json
